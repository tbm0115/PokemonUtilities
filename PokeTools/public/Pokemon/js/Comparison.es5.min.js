"use strict";function BuildComparison(){var u,f,o,i,n,e,s,t,h,r;for($("#compareMessage").html(""),u=[],f={items:null,properties:["speed","special-defense","special-attack","defense","attack","hp"]},o=ComparePokemon.length,i=0;i<o;i++)if(n=ComparePokemon[i],typeof n!="undefined"&&n!==null){for(e={speed:0,"special-defense":0,"special-attack":0,defense:0,attack:0,hp:0},s=n.stats.length,t=0;t<s;t++)e[n.stats[t].stat.name]=n.stats[t].base_stat;h=new ComparisonDTO(n.name,n.id,n.species.color.name,e,"/PokeApi"+n.sprites.front_default);u.push(h)}f.items=u;$("#pokeComparison").length>0&&(r=$("#pokeComparison").Comparison(f),r!==null&&r.length>0&&(r[0].Draw(),$("#pokeComparison").trigger("compared",[ComparePokemon])))}var ComparisonDTO=function(n,t,i,r,u){return this.name=n,this.id=t,this.color=i,this.stats=r,this.icon=u,this},name2hsl=function(n){var i=function(n,t,i){return i=i+(100-i)/2,"hsl("+n.toString()+", "+t.toString()+"%, "+i.toFixed(0).toString()+"%)"},t={};return t.black=i(0,0,0),t.blue=i(240,100,50),t.brown=i(0,59,41),t.gray=i(0,0,50),t.green=i(120,100,25),t.pink=i(350,100,88),t.purple=i(300,100,25),t.red=i(0,100,50),t.white=i(0,0,100),t.yellow=i(60,100,50),n in t?t[n]:t.black},ComparePokemon;$.fn.Comparison=function(n){return $(this).filter(function(n,t){return t.nodeName==="CANVAS"}).each(function(){var i=$(this),t=i[0];return t.Options=n,"fncOnMouseMove"in t||(t.fncGetMousePos=function(n){var t=this.getBoundingClientRect();return{x:n.clientX-t.left,y:n.clientY-t.top}}.bind(t),t.fncOnMouseMove=function(n){var t=this.fncGetMousePos(n);this.Draw(t)}.bind(t),t.onmousemove=t.fncOnMouseMove),t.elImageContainer={},t.Draw=function(n){var i=this.Options.items,o=this.getBoundingClientRect(),d,r,rt,l,tt,ht,f;this.width=o.width;this.height=o.height;var s={pokemon:null,stat:"",val:""},b=this.Options.properties,k=Math.min(o.width,o.height)/2*.75,a=k/(b.length-1),h=360/i.length,t=this.getContext("2d"),c=function(n,t){return this.Radius=n,this.Theta=t,this.toCartesian=function(){return{x:Math.floor(this.Radius*Math.cos(this.Theta)),y:Math.floor(this.Radius*Math.sin(this.Theta))}}.bind(this),this.Cartesian=this.toCartesian(),this};if(i.length>0){for(t.translate(o.width/2,o.height/2),d=i.length,r=0;r<d;r++){for(t.rotate(2*(r+1/d)*Math.PI),rt=b.length,l=0;l<rt;l++){t.strokeStyle="black";t.fillStyle=name2hsl(i[r].color);t.lineWidth=1;var y=b[l],v=i[r].stats[y],lt=r>0?i[r-1]:i[i.length-1],at=r<i.length-1?i[r+1]:i[0],ut={left:v/(v+lt.stats[y]),right:v/(v+at.stats[y])},vt=h/2,g=l*a,nt=l*a+a,ft=vt,p=ft-h*ut.left,w=ft+h*ut.right,et=new c(g,p*Math.PI/180),ot=new c(nt,p*Math.PI/180),st=new c(nt,w*Math.PI/180),yt=new c(g,w*Math.PI/180);t.beginPath();t.moveTo(et.Cartesian.x,et.Cartesian.y);t.lineTo(ot.Cartesian.x,ot.Cartesian.y);t.arc(0,0,nt,p*Math.PI/180,w*Math.PI/180);t.lineTo(st.Cartesian.x,st.Cartesian.y);t.arc(0,0,g,w*Math.PI/180,p*Math.PI/180,!0);typeof n!="undefined"&&n!==null&&t.isPointInPath(n.x,n.y)&&(s.stat=y,s.val=v,s.pokemon=i[r].name,t.lineWidth=2.5,t.strokeStyle="navyblue");t.stroke();t.closePath();t.fill()}t.strokeStyle="black";tt=new c(k,0);t.beginPath();t.moveTo(0,0);t.lineTo(tt.Cartesian.x,tt.Cartesian.y);t.arc(0,0,k+a,0,h*Math.PI/180);t.lineTo(0,0);t.stroke();t.closePath()}t.restore()}else t.restore(),t.textAlign="center",t.textBaseline="middle",t.fillText("Add Pokemon",Math.floor(this.width/2),Math.floor(this.height/2),Math.floor(this.width*.75));for(ht=i.length,f=0;f<ht;f++){var u=Math.min(96,a*4),ct=new c(Math.min(this.width,this.height)*.9/2,(h/2+h*(f+1))*Math.PI/180),e=this.elImageContainer[i[f].id],it={x:Math.floor(ct.Cartesian.x)-u/2,y:Math.floor(ct.Cartesian.y)-u/2};typeof e=="undefined"||e===null||e.data===null?(this.elImageContainer[i[f].id]={img:new Image(u,u),canv:document.createElement("canvas")},e=this.elImageContainer[i[f].id],e.canv.width=u,e.canv.height=u,e.img.onload=function(){console.log("\tReceived new image data!",this);t.drawImage(this.data.img,this.point.x,this.point.y,u,u)}.bind({point:it,data:this.elImageContainer[i[f].id]}),console.log("Requesting new image data..."),e.img.src=i[f].icon):t.drawImage(e.img,it.x,it.y,u,u)}return s.pokemon!==null&&s.pokemon!==""&&$(this).trigger("message",[s]),i}.bind(t),t.Draw(),i})};ComparePokemon=[];$(document).ready(function(){$("#pokeComparison").on("message",function(n,t){$("#compareMessage").html("<strong>"+t.pokemon.substr(0,1).toUpperCase()+t.pokemon.substr(1)+"<\/strong> "+t.stat.substr(0,1).toUpperCase()+t.stat.substr(1)+" = "+t.val.toString())});BuildComparison()});$(document).ready(function(){$(window).on("resize",function(){var n=document.querySelector("#pokeComparison");typeof n!="undefined"&&n!==null&&n.Draw()})});